# Activity Object Definition
# æ´»åŠ¨è®°å½•ç®¡ç† - Sales Force Automation Domain
# Follows @objectstack/spec standard for enterprise CRM

name: Activity
label: æ´»åŠ¨
labelPlural: æ´»åŠ¨
icon: calendar-check
description: é”€å”®è·Ÿè¿›æ´»åŠ¨è®°å½•ï¼ŒåŒ…æ‹¬æ‹œè®¿ã€ç”µè¯ã€é‚®ä»¶ç­‰

# Enable core features
features:
  searchable: true
  trackFieldHistory: true
  enableNotes: false
  enableAttachments: true

# Field Definitions
fields:
  # Basic Information
  - name: Subject
    type: text
    label: ä¸»é¢˜
    required: true
    searchable: true
    length: 255
    
  - name: Type
    type: select
    label: æ´»åŠ¨ç±»å‹
    required: true
    options:
      - label: ğŸ“ ç”µè¯
        value: Call
      - label: ğŸ“§ é‚®ä»¶
        value: Email
      - label: ğŸ¤ æ‹œè®¿
        value: Meeting
      - label: ğŸ“ ä»»åŠ¡
        value: Task
      - label: ğŸ¤ æ¼”ç¤º
        value: Demo
      - label: ğŸ“Š ææ¡ˆ
        value: Proposal
      - label: ğŸ½ï¸ å•†åŠ¡é¤é¥®
        value: Lunch
      - label: ğŸ¯ å…¶ä»–
        value: Other
        
  - name: Status
    type: select
    label: çŠ¶æ€
    required: true
    defaultValue: Planned
    options:
      - label: ğŸ“‹ è®¡åˆ’ä¸­
        value: Planned
      - label: ğŸš€ è¿›è¡Œä¸­
        value: In Progress
      - label: âœ… å·²å®Œæˆ
        value: Completed
      - label: âŒ å·²å–æ¶ˆ
        value: Cancelled
      - label: â° å»¶æœŸ
        value: Deferred
        
  - name: Priority
    type: select
    label: ä¼˜å…ˆçº§
    defaultValue: Medium
    options:
      - label: ğŸ”´ é«˜
        value: High
      - label: ğŸŸ¡ ä¸­
        value: Medium
      - label: ğŸŸ¢ ä½
        value: Low
        
  # Date & Time
  - name: ActivityDate
    type: datetime
    label: æ´»åŠ¨æ—¶é—´
    required: true
    
  - name: DueDate
    type: date
    label: åˆ°æœŸæ—¥æœŸ
    
  - name: EndDateTime
    type: datetime
    label: ç»“æŸæ—¶é—´
    
  - name: DurationInMinutes
    type: number
    label: æŒç»­æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
    precision: 0
    
  # Related Records
  - name: WhoId
    type: lookup
    label: ç›¸å…³äººå‘˜
    referenceTo: [Contact, Lead]
    description: å…³è”åˆ°è”ç³»äººæˆ–çº¿ç´¢
    
  - name: WhatId
    type: lookup
    label: ç›¸å…³å¯¹è±¡
    referenceTo: [Account, Opportunity, Contract]
    description: å…³è”åˆ°å®¢æˆ·ã€å•†æœºæˆ–åˆåŒ
    
  - name: OwnerId
    type: lookup
    label: è´Ÿè´£äºº
    referenceTo: User
    required: true
    
  # Location
  - name: Location
    type: text
    label: åœ°ç‚¹
    length: 255
    
  - name: IsOnline
    type: checkbox
    label: çº¿ä¸Šæ´»åŠ¨
    defaultValue: false
    
  - name: MeetingLink
    type: url
    label: ä¼šè®®é“¾æ¥
    description: Zoom/Teams/è…¾è®¯ä¼šè®®ç­‰é“¾æ¥
    
  # Check-in (æ‹œè®¿ç­¾åˆ°)
  - name: CheckInTime
    type: datetime
    label: ç­¾åˆ°æ—¶é—´
    readonly: true
    
  - name: CheckInLocation
    type: text
    label: ç­¾åˆ°åœ°ç‚¹
    readonly: true
    length: 255
    
  - name: CheckInLatitude
    type: number
    label: ç­¾åˆ°çº¬åº¦
    readonly: true
    precision: 7
    
  - name: CheckInLongitude
    type: number
    label: ç­¾åˆ°ç»åº¦
    readonly: true
    precision: 7
    
  # Call Details
  - name: CallType
    type: select
    label: ç”µè¯ç±»å‹
    options:
      - label: å‘¼å‡º
        value: Outbound
      - label: å‘¼å…¥
        value: Inbound
      - label: å†…éƒ¨
        value: Internal
        
  - name: CallDurationInSeconds
    type: number
    label: é€šè¯æ—¶é•¿ï¼ˆç§’ï¼‰
    precision: 0
    readonly: true
    
  - name: CallResult
    type: select
    label: é€šè¯ç»“æœ
    options:
      - label: âœ… æ¥é€š
        value: Connected
      - label: âŒ æœªæ¥é€š
        value: Not Connected
      - label: ğŸ“§ ç•™è¨€
        value: Left Message
      - label: â° ç¨åå†æ‰“
        value: Call Back Later
      - label: ğŸš« æ‹’ç»
        value: Rejected
        
  # Email Details
  - name: EmailSubject
    type: text
    label: é‚®ä»¶ä¸»é¢˜
    length: 255
    
  - name: EmailBody
    type: textarea
    label: é‚®ä»¶æ­£æ–‡
    length: 32000
    
  - name: EmailFromAddress
    type: email
    label: å‘ä»¶äºº
    
  - name: EmailToAddress
    type: email
    label: æ”¶ä»¶äºº
    
  - name: EmailCcAddress
    type: text
    label: æŠ„é€
    length: 500
    
  # Content & Notes
  - name: Description
    type: textarea
    label: æè¿°/å¤‡æ³¨
    length: 32000
    searchable: true
    
  # AI Enhancement Fields
  - name: AITranscription
    type: textarea
    label: AI è¯­éŸ³è½¬æ–‡å­—
    readonly: true
    length: 32000
    description: ä¼šè®®å½•éŸ³è‡ªåŠ¨è½¬æ–‡å­—
    
  - name: AIActionItems
    type: textarea
    label: AI æå–è¡ŒåŠ¨é¡¹
    readonly: true
    length: 5000
    description: ä»ä¼šè®®/é€šè¯ä¸­è‡ªåŠ¨æå–å¾…åŠäº‹é¡¹
    
  - name: AISentimentAnalysis
    type: select
    label: AI æƒ…ç»ªåˆ†æ
    readonly: true
    options:
      - label: ğŸ˜Š ç§¯æ
        value: Positive
      - label: ğŸ˜ ä¸­æ€§
        value: Neutral
      - label: ğŸ˜Ÿ æ¶ˆæ
        value: Negative
        
  - name: AIKeyPoints
    type: textarea
    label: AI å…³é”®è¦ç‚¹
    readonly: true
    length: 2000
    description: AI æ€»ç»“çš„ä¼šè®®/é€šè¯å…³é”®ä¿¡æ¯
    
  - name: AINextStepSuggestion
    type: text
    label: AI ä¸‹ä¸€æ­¥å»ºè®®
    readonly: true
    length: 500

# Relationships
relationships:
  - name: Attachments
    type: hasMany
    object: Attachment
    foreignKey: ParentId
    label: é™„ä»¶

# List Views
listViews:
  - name: AllActivities
    label: æ‰€æœ‰æ´»åŠ¨
    filters: []
    columns:
      - Subject
      - Type
      - Status
      - ActivityDate
      - Who
      - What
      - Owner
    sortBy: ActivityDate
    sortOrder: desc
    
  - name: MyActivities
    label: æˆ‘çš„æ´»åŠ¨
    filters:
      - field: OwnerId
        operator: equals
        value: $CurrentUser.Id
    columns:
      - Subject
      - Type
      - Status
      - Priority
      - ActivityDate
      - Who
      - What
    sortBy: ActivityDate
    sortOrder: desc
    
  - name: TodayActivities
    label: ä»Šæ—¥æ´»åŠ¨
    filters:
      - field: ActivityDate
        operator: today
      - field: OwnerId
        operator: equals
        value: $CurrentUser.Id
    columns:
      - Subject
      - Type
      - Status
      - ActivityDate
      - Who
      - What
      - Location
    sortBy: ActivityDate
    sortOrder: asc
    
  - name: UpcomingActivities
    label: å³å°†åˆ°æ¥
    filters:
      - field: ActivityDate
        operator: next_n_days
        value: 7
      - field: Status
        operator: notIn
        value: [Completed, Cancelled]
    columns:
      - Subject
      - Type
      - Priority
      - ActivityDate
      - Who
      - What
      - Owner
    sortBy: ActivityDate
    sortOrder: asc
    
  - name: OverdueActivities
    label: é€¾æœŸæ´»åŠ¨
    filters:
      - field: DueDate
        operator: lessThan
        value: $TODAY
      - field: Status
        operator: notIn
        value: [Completed, Cancelled]
    columns:
      - Subject
      - Type
      - Priority
      - DueDate
      - Who
      - What
      - Owner
    sortBy: DueDate
    sortOrder: asc
    
  - name: Meetings
    label: ä¼šè®®è®°å½•
    filters:
      - field: Type
        operator: equals
        value: Meeting
      - field: Status
        operator: equals
        value: Completed
    columns:
      - Subject
      - ActivityDate
      - Location
      - Who
      - What
      - Owner
      - AIKeyPoints
    sortBy: ActivityDate
    sortOrder: desc

# Page Layout
pageLayout:
  sections:
    - label: æ´»åŠ¨ä¿¡æ¯
      columns: 2
      fields:
        - Subject
        - Type
        - Status
        - Priority
        - OwnerId
        
    - label: æ—¥æœŸä¸æ—¶é—´
      columns: 2
      fields:
        - ActivityDate
        - EndDateTime
        - DueDate
        - DurationInMinutes
        
    - label: å…³è”è®°å½•
      columns: 2
      fields:
        - WhoId
        - WhatId
        
    - label: åœ°ç‚¹ä¿¡æ¯
      columns: 2
      fields:
        - Location
        - IsOnline
        - MeetingLink
        
    - label: æ‹œè®¿ç­¾åˆ°
      columns: 2
      fields:
        - CheckInTime
        - CheckInLocation
        - CheckInLatitude
        - CheckInLongitude
        
    - label: ç”µè¯è¯¦æƒ…
      columns: 2
      fields:
        - CallType
        - CallDurationInSeconds
        - CallResult
        
    - label: é‚®ä»¶è¯¦æƒ…
      columns: 2
      fields:
        - EmailSubject
        - EmailFromAddress
        - EmailToAddress
        - EmailCcAddress
        
    - label: AI æ™ºèƒ½åˆ†æ
      columns: 1
      fields:
        - AITranscription
        - AIActionItems
        - AIKeyPoints
        - AISentimentAnalysis
        - AINextStepSuggestion
        
    - label: æè¿°ä¸å¤‡æ³¨
      columns: 1
      fields:
        - Description
        - EmailBody

# Validation Rules
validationRules:
  - name: EndDateTimeAfterStart
    errorMessage: ç»“æŸæ—¶é—´å¿…é¡»æ™šäºå¼€å§‹æ—¶é—´
    formula: |
      AND(
        NOT(ISBLANK(ActivityDate)),
        NOT(ISBLANK(EndDateTime)),
        EndDateTime < ActivityDate
      )
      
  - name: MeetingRequiresLocation
    errorMessage: çº¿ä¸‹ä¼šè®®å¿…é¡»å¡«å†™åœ°ç‚¹
    formula: |
      AND(
        Type = "Meeting",
        IsOnline = false,
        ISBLANK(Location)
      )
      
  - name: OnlineMeetingRequiresLink
    errorMessage: çº¿ä¸Šä¼šè®®å»ºè®®å¡«å†™ä¼šè®®é“¾æ¥
    formula: |
      AND(
        Type = "Meeting",
        IsOnline = true,
        ISBLANK(MeetingLink)
      )

# Triggers
triggers:
  - name: ActivityAIAnalysis
    event: afterInsert, afterUpdate
    description: AI åˆ†ææ´»åŠ¨å†…å®¹å¹¶æå–å…³é”®ä¿¡æ¯
    
  - name: ActivityCompletionTracking
    event: afterUpdate
    description: è¿½è¸ªæ´»åŠ¨å®Œæˆæƒ…å†µå¹¶æ›´æ–°å…³è”è®°å½•
