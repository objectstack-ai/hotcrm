# Contract Object Definition
# Follows @objectstack/spec standard for enterprise CRM

name: Contract
label: åˆåŒ
labelPlural: åˆåŒ
icon: file-text
description: åˆåŒç®¡ç†

# Enable core features
features:
  searchable: true
  trackFieldHistory: true
  enableNotes: true
  enableAttachments: true

# Field Definitions
fields:
  # Basic Information
  - name: ContractNumber
    type: autoNumber
    label: åˆåŒç¼–å·
    format: "CT-{YYYY}{MM}{DD}-{0000}"
    
  - name: AccountId
    type: lookup
    label: å®¢æˆ·
    referenceTo: Account
    required: true
    
  - name: OpportunityId
    type: lookup
    label: å…³è”å•†æœº
    referenceTo: Opportunity
    
  - name: Status
    type: select
    label: çŠ¶æ€
    required: true
    defaultValue: Draft
    options:
      - label: ğŸ“ è‰ç¨¿
        value: Draft
      - label: ğŸ” å®¡æ ¸ä¸­
        value: In Approval
      - label: âœ… å·²æ¿€æ´»
        value: Activated
      - label: â¸ï¸ æš‚åœ
        value: On Hold
      - label: âœ”ï¸ å·²å®Œæˆ
        value: Completed
      - label: âŒ å·²ç»ˆæ­¢
        value: Terminated
        
  # Contract Terms
  - name: StartDate
    type: date
    label: å¼€å§‹æ—¥æœŸ
    required: true
    
  - name: EndDate
    type: date
    label: ç»“æŸæ—¥æœŸ
    
  - name: ContractTerm
    type: number
    label: åˆåŒæœŸé™ï¼ˆæœˆï¼‰
    
  - name: BillingFrequency
    type: select
    label: è´¦å•å‘¨æœŸ
    options:
      - label: æœˆä»˜
        value: Monthly
      - label: å­£ä»˜
        value: Quarterly
      - label: åŠå¹´ä»˜
        value: Semi-Annual
      - label: å¹´ä»˜
        value: Annual
      - label: ä¸€æ¬¡æ€§
        value: One-Time
        
  # Financial
  - name: ContractValue
    type: currency
    label: åˆåŒé‡‘é¢
    precision: 2
    required: true
    
  - name: PaymentTerms
    type: select
    label: ä»˜æ¬¾æ¡ä»¶
    options:
      - label: é¢„ä»˜æ¬¾
        value: Prepaid
      - label: è´§åˆ°ä»˜æ¬¾
        value: Net 0
      - label: 15å¤©å†…ä»˜æ¬¾
        value: Net 15
      - label: 30å¤©å†…ä»˜æ¬¾
        value: Net 30
      - label: 60å¤©å†…ä»˜æ¬¾
        value: Net 60
      - label: 90å¤©å†…ä»˜æ¬¾
        value: Net 90
        
  # Renewal
  - name: AutoRenewal
    type: checkbox
    label: è‡ªåŠ¨ç»­çº¦
    defaultValue: false
    
  - name: RenewalNoticeDate
    type: date
    label: ç»­çº¦é€šçŸ¥æ—¥æœŸ
    
  - name: RenewalTerm
    type: number
    label: ç»­çº¦æœŸé™ï¼ˆæœˆï¼‰
    
  # Legal
  - name: SpecialTerms
    type: textarea
    label: ç‰¹æ®Šæ¡æ¬¾
    rows: 5
    
  - name: Description
    type: textarea
    label: æè¿°
    rows: 5
    
  # Signatures
  - name: CustomerSignedDate
    type: date
    label: å®¢æˆ·ç­¾ç½²æ—¥æœŸ
    
  - name: CustomerSignedBy
    type: text
    label: å®¢æˆ·ç­¾ç½²äºº
    length: 100
    
  - name: CompanySignedDate
    type: date
    label: å…¬å¸ç­¾ç½²æ—¥æœŸ
    
  - name: CompanySignedBy
    type: lookup
    label: å…¬å¸ç­¾ç½²äºº
    referenceTo: User
    
  # Ownership
  - name: OwnerId
    type: lookup
    label: è´Ÿè´£äºº
    referenceTo: User
    required: true
    defaultValue: $currentUser

# List Views
listViews:
  - name: All
    label: æ‰€æœ‰åˆåŒ
    filters: []
    columns:
      - ContractNumber
      - AccountId
      - Status
      - StartDate
      - EndDate
      - ContractValue
      - OwnerId
      
  - name: MyContracts
    label: æˆ‘çš„åˆåŒ
    filters:
      - field: OwnerId
        operator: equals
        value: $currentUser
    columns:
      - ContractNumber
      - AccountId
      - Status
      - StartDate
      - ContractValue
      
  - name: Active
    label: æ´»è·ƒåˆåŒ
    filters:
      - field: Status
        operator: equals
        value: Activated
    columns:
      - ContractNumber
      - AccountId
      - StartDate
      - EndDate
      - ContractValue
      - AutoRenewal
      
  - name: ExpiringThisQuarter
    label: æœ¬å­£åˆ°æœŸ
    filters:
      - field: EndDate
        operator: thisQuarter
    sortBy: EndDate
    sortOrder: asc
    columns:
      - ContractNumber
      - AccountId
      - EndDate
      - ContractValue
      - AutoRenewal
      - RenewalNoticeDate

# Page Layout
pageLayout:
  sections:
    - label: åˆåŒä¿¡æ¯
      columns: 2
      fields:
        - ContractNumber
        - AccountId
        - OpportunityId
        - Status
        - OwnerId
        
    - label: åˆåŒæœŸé™
      columns: 2
      fields:
        - StartDate
        - EndDate
        - ContractTerm
        - BillingFrequency
        
    - label: è´¢åŠ¡ä¿¡æ¯
      columns: 2
      fields:
        - ContractValue
        - PaymentTerms
        
    - label: ç»­çº¦ä¿¡æ¯
      columns: 2
      fields:
        - AutoRenewal
        - RenewalNoticeDate
        - RenewalTerm
        
    - label: ç­¾ç½²ä¿¡æ¯
      columns: 2
      fields:
        - CustomerSignedDate
        - CustomerSignedBy
        - CompanySignedDate
        - CompanySignedBy
        
    - label: å…¶ä»–
      columns: 1
      fields:
        - SpecialTerms
        - Description

# Validation Rules
validationRules:
  - name: EndDateAfterStartDate
    errorMessage: ç»“æŸæ—¥æœŸå¿…é¡»æ™šäºå¼€å§‹æ—¥æœŸ
    formula: |
      AND(
        NOT(ISBLANK(EndDate)),
        EndDate <= StartDate
      )
      
  - name: RequireSignatureForActivation
    errorMessage: æ¿€æ´»åˆåŒå‰å¿…é¡»å®ŒæˆåŒæ–¹ç­¾ç½²
    formula: |
      AND(
        Status = "Activated",
        OR(
          ISBLANK(CustomerSignedDate),
          ISBLANK(CompanySignedDate)
        )
      )
