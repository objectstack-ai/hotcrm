# Campaign Object Definition
# å¸‚åœºæ´»åŠ¨ç®¡ç† - Marketing & Leads Domain
# Follows @objectstack/spec standard for enterprise CRM

name: Campaign
label: è¥é”€æ´»åŠ¨
labelPlural: è¥é”€æ´»åŠ¨
icon: megaphone
description: è¥é”€æ´»åŠ¨ç­–åˆ’ã€æ‰§è¡Œå’ŒROIåˆ†æ

# Enable core features
features:
  searchable: true
  trackFieldHistory: true
  enableActivities: true
  enableNotes: true
  enableAttachments: true

# Field Definitions
fields:
  # Basic Information
  - name: Name
    type: text
    label: æ´»åŠ¨åç§°
    required: true
    searchable: true
    length: 140
    
  - name: Type
    type: select
    label: æ´»åŠ¨ç±»å‹
    options:
      - label: ä¼šè®®/ç ”è®¨ä¼š
        value: Conference
      - label: ç½‘ç»œç ”è®¨ä¼š
        value: Webinar
      - label: å±•ä¼š
        value: Trade Show
      - label: é‚®ä»¶è¥é”€
        value: Email
      - label: ç¤¾äº¤åª’ä½“
        value: Social Media
      - label: å¹¿å‘Šæ´»åŠ¨
        value: Advertisement
      - label: ç›´é‚®
        value: Direct Mail
      - label: åˆä½œä¼™ä¼´
        value: Partners
      - label: å…¶ä»–
        value: Other
        
  - name: Status
    type: select
    label: çŠ¶æ€
    required: true
    defaultValue: Planned
    options:
      - label: ğŸ“‹ è®¡åˆ’ä¸­
        value: Planned
      - label: ğŸš€ è¿›è¡Œä¸­
        value: In Progress
      - label: âœ… å·²å®Œæˆ
        value: Completed
      - label: âŒ å·²å–æ¶ˆ
        value: Aborted
      - label: â¸ï¸ æš‚åœ
        value: On Hold
        
  # Dates
  - name: StartDate
    type: date
    label: å¼€å§‹æ—¥æœŸ
    
  - name: EndDate
    type: date
    label: ç»“æŸæ—¥æœŸ
    
  # Budget & ROI
  - name: BudgetedCost
    type: currency
    label: é¢„ç®—æˆæœ¬
    precision: 2
    
  - name: ActualCost
    type: currency
    label: å®é™…æˆæœ¬
    precision: 2
    
  - name: ExpectedRevenue
    type: currency
    label: é¢„æœŸæ”¶å…¥
    precision: 2
    
  - name: ActualRevenue
    type: currency
    label: å®é™…æ”¶å…¥
    precision: 2
    readonly: true
    description: ä»å…³è”çš„å·²èµ¢å•†æœºè‡ªåŠ¨æ±‡æ€»
    
  - name: ROI
    type: percent
    label: æŠ•èµ„å›æŠ¥ç‡ (ROI)
    readonly: true
    description: è‡ªåŠ¨è®¡ç®— = (å®é™…æ”¶å…¥ - å®é™…æˆæœ¬) / å®é™…æˆæœ¬
    
  # Targets & Results
  - name: NumberSent
    type: number
    label: å‘é€æ•°é‡
    precision: 0
    description: è¥é”€ææ–™å‘é€æ•°é‡ï¼ˆå¦‚é‚®ä»¶ï¼‰
    
  - name: ExpectedResponse
    type: number
    label: é¢„æœŸå“åº”æ•°
    precision: 0
    
  - name: NumberOfLeads
    type: number
    label: äº§ç”Ÿçº¿ç´¢æ•°
    precision: 0
    readonly: true
    description: ä»æ´»åŠ¨äº§ç”Ÿçš„çº¿ç´¢æ€»æ•°
    
  - name: NumberOfConvertedLeads
    type: number
    label: è½¬åŒ–çº¿ç´¢æ•°
    precision: 0
    readonly: true
    description: è½¬åŒ–ä¸ºå•†æœºçš„çº¿ç´¢æ•°é‡
    
  - name: NumberOfOpportunities
    type: number
    label: äº§ç”Ÿå•†æœºæ•°
    precision: 0
    readonly: true
    
  - name: NumberOfWonOpportunities
    type: number
    label: èµ¢å•æ•°é‡
    precision: 0
    readonly: true
    
  - name: ConversionRate
    type: percent
    label: è½¬åŒ–ç‡
    readonly: true
    description: è½¬åŒ–çº¿ç´¢æ•° / æ€»çº¿ç´¢æ•°
    
  # Ownership
  - name: OwnerId
    type: lookup
    label: è´Ÿè´£äºº
    referenceTo: User
    required: true
    
  - name: ParentCampaignId
    type: lookup
    label: çˆ¶çº§æ´»åŠ¨
    referenceTo: Campaign
    description: æ”¯æŒæ´»åŠ¨å±‚çº§å…³ç³»
    
  # Description
  - name: Description
    type: textarea
    label: æ´»åŠ¨æè¿°
    length: 32000
    
  # AI Enhancement Fields
  - name: AIGeneratedContent
    type: textarea
    label: AI ç”Ÿæˆå†…å®¹
    readonly: true
    length: 5000
    description: AI è‡ªåŠ¨ç”Ÿæˆçš„è¥é”€é‚®ä»¶æ–‡æ¡ˆæˆ–æ´»åŠ¨è½åœ°é¡µå¤§çº²
    
  - name: AITargetAudience
    type: textarea
    label: AI ç›®æ ‡å—ä¼—åˆ†æ
    readonly: true
    length: 2000
    
  - name: AIRecommendedChannels
    type: text
    label: AI æ¨èæ¸ é“
    readonly: true
    length: 500

# Relationships
relationships:
  - name: CampaignMembers
    type: hasMany
    object: CampaignMember
    foreignKey: CampaignId
    label: æ´»åŠ¨æˆå‘˜
    
  - name: Leads
    type: hasMany
    object: Lead
    foreignKey: CampaignId
    label: å…³è”çº¿ç´¢
    
  - name: Opportunities
    type: hasMany
    object: Opportunity
    foreignKey: CampaignId
    label: å…³è”å•†æœº
    
  - name: ChildCampaigns
    type: hasMany
    object: Campaign
    foreignKey: ParentCampaignId
    label: å­æ´»åŠ¨

# List Views
listViews:
  - name: AllCampaigns
    label: æ‰€æœ‰æ´»åŠ¨
    filters: []
    columns:
      - Name
      - Type
      - Status
      - StartDate
      - EndDate
      - BudgetedCost
      - ActualCost
      - ROI
      - Owner
    sortBy: StartDate
    sortOrder: desc
    
  - name: MyCampaigns
    label: æˆ‘çš„æ´»åŠ¨
    filters:
      - field: OwnerId
        operator: equals
        value: $CurrentUser.Id
    columns:
      - Name
      - Type
      - Status
      - StartDate
      - NumberOfLeads
      - NumberOfOpportunities
      - ROI
    sortBy: StartDate
    sortOrder: desc
    
  - name: ActiveCampaigns
    label: è¿›è¡Œä¸­çš„æ´»åŠ¨
    filters:
      - field: Status
        operator: in
        value: [Planned, In Progress]
    columns:
      - Name
      - Type
      - Status
      - StartDate
      - EndDate
      - BudgetedCost
      - NumberOfLeads
      - Owner
    sortBy: StartDate
    sortOrder: asc
    
  - name: HighROICampaigns
    label: é«˜ ROI æ´»åŠ¨
    filters:
      - field: Status
        operator: equals
        value: Completed
      - field: ROI
        operator: greaterThan
        value: 1.0
    columns:
      - Name
      - Type
      - ActualCost
      - ActualRevenue
      - ROI
      - NumberOfWonOpportunities
      - Owner
    sortBy: ROI
    sortOrder: desc
    
  - name: ThisQuarter
    label: æœ¬å­£åº¦æ´»åŠ¨
    filters:
      - field: StartDate
        operator: this_quarter
    columns:
      - Name
      - Type
      - Status
      - StartDate
      - BudgetedCost
      - NumberOfLeads
      - ConversionRate
    sortBy: StartDate
    sortOrder: desc

# Page Layout
pageLayout:
  sections:
    - label: æ´»åŠ¨ä¿¡æ¯
      columns: 2
      fields:
        - Name
        - Type
        - Status
        - OwnerId
        - ParentCampaignId
        
    - label: æ—¥æœŸ
      columns: 2
      fields:
        - StartDate
        - EndDate
        
    - label: é¢„ç®—ä¸æˆæœ¬
      columns: 2
      fields:
        - BudgetedCost
        - ActualCost
        - ExpectedRevenue
        - ActualRevenue
        - ROI
        
    - label: ç›®æ ‡ä¸ç»“æœ
      columns: 2
      fields:
        - NumberSent
        - ExpectedResponse
        - NumberOfLeads
        - NumberOfConvertedLeads
        - NumberOfOpportunities
        - NumberOfWonOpportunities
        - ConversionRate
        
    - label: AI è¥é”€åŠ©æ‰‹
      columns: 1
      fields:
        - AIGeneratedContent
        - AITargetAudience
        - AIRecommendedChannels
        
    - label: æè¿°
      columns: 1
      fields:
        - Description

# Validation Rules
validationRules:
  - name: EndDateAfterStartDate
    errorMessage: ç»“æŸæ—¥æœŸå¿…é¡»æ™šäºå¼€å§‹æ—¥æœŸ
    formula: |
      AND(
        NOT(ISBLANK(StartDate)),
        NOT(ISBLANK(EndDate)),
        EndDate < StartDate
      )
      
  - name: ActualCostWithinBudget
    errorMessage: å®é™…æˆæœ¬è¶…å‡ºé¢„ç®—ï¼Œéœ€è¦å®¡æ‰¹
    formula: |
      AND(
        NOT(ISBLANK(BudgetedCost)),
        NOT(ISBLANK(ActualCost)),
        ActualCost > BudgetedCost * 1.2
      )
      
  - name: CompletedCampaignRequiresActualCost
    errorMessage: å·²å®Œæˆçš„æ´»åŠ¨å¿…é¡»å¡«å†™å®é™…æˆæœ¬
    formula: |
      AND(
        Status = "Completed",
        ISBLANK(ActualCost)
      )

# Triggers
triggers:
  - name: CampaignROICalculation
    event: beforeUpdate
    description: è‡ªåŠ¨è®¡ç®— ROI å’Œè½¬åŒ–ç‡
    
  - name: CampaignMemberAggregation
    event: afterUpdate
    description: æ±‡æ€»æ´»åŠ¨æˆå‘˜ç»Ÿè®¡æ•°æ®
