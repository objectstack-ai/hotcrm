# Lead Object Definition
# çº¿ç´¢ç®¡ç† - Marketing & Leads Domain
# Follows @objectstack/spec standard for enterprise CRM

name: Lead
label: çº¿ç´¢
labelPlural: çº¿ç´¢
icon: user-plus
description: æ½œåœ¨å®¢æˆ·çº¿ç´¢ç®¡ç†ï¼ŒåŒ…æ‹¬çº¿ç´¢æ‰“åˆ†ã€å…¬æµ·æ± å’Œè‡ªåŠ¨åˆ†é…

# Enable core features
features:
  searchable: true
  trackFieldHistory: true
  enableActivities: true
  enableNotes: true
  enableAttachments: true
  enableDuplicateDetection: true

# Field Definitions
fields:
  # Basic Information
  - name: FirstName
    type: text
    label: å
    length: 40
    
  - name: LastName
    type: text
    label: å§“
    required: true
    length: 80
    searchable: true
    
  - name: Company
    type: text
    label: å…¬å¸
    required: true
    length: 255
    searchable: true
    
  - name: Title
    type: text
    label: èŒä½
    length: 128
    
  # Contact Information
  - name: Email
    type: email
    label: é‚®ç®±
    unique: true
    searchable: true
    
  - name: Phone
    type: phone
    label: ç”µè¯
    
  - name: MobilePhone
    type: phone
    label: æ‰‹æœº
    
  - name: Website
    type: url
    label: ç½‘ç«™
    
  # Address
  - name: Street
    type: text
    label: è¡—é“åœ°å€
    length: 255
    
  - name: City
    type: text
    label: åŸå¸‚
    length: 40
    
  - name: State
    type: text
    label: çœ/å·
    length: 80
    
  - name: PostalCode
    type: text
    label: é‚®ç¼–
    length: 20
    
  - name: Country
    type: text
    label: å›½å®¶
    length: 80
    
  # Lead Classification
  - name: Status
    type: select
    label: çŠ¶æ€
    required: true
    defaultValue: New
    options:
      - label: ğŸ†• æ–°çº¿ç´¢
        value: New
      - label: ğŸ“ è”ç³»ä¸­
        value: Working
      - label: ğŸ”„ åŸ¹è‚²ä¸­
        value: Nurturing
      - label: âœ… å·²è½¬åŒ–
        value: Converted
      - label: âŒ ä¸åˆæ ¼
        value: Unqualified
        
  - name: Rating
    type: select
    label: è¯„çº§
    options:
      - label: ğŸ”¥ Hot (çƒ­)
        value: Hot
      - label: âš¡ Warm (æ¸©)
        value: Warm
      - label: â„ï¸ Cold (å†·)
        value: Cold
        
  - name: LeadSource
    type: select
    label: çº¿ç´¢æ¥æº
    options:
      - label: Web å®˜ç½‘
        value: Web
      - label: Phone Inquiry ç”µè¯å’¨è¯¢
        value: Phone Inquiry
      - label: Partner Referral åˆä½œä¼™ä¼´æ¨è
        value: Partner Referral
      - label: Purchased List è´­ä¹°åå•
        value: Purchased List
      - label: Trade Show å±•ä¼š
        value: Trade Show
      - label: Social Media ç¤¾äº¤åª’ä½“
        value: Social Media
      - label: Advertisement å¹¿å‘Š
        value: Advertisement
      - label: Other å…¶ä»–
        value: Other
        
  - name: Industry
    type: select
    label: è¡Œä¸š
    options:
      - label: ç§‘æŠ€
        value: Technology
      - label: é‡‘è
        value: Finance
      - label: åŒ»ç–—
        value: Healthcare
      - label: åˆ¶é€ 
        value: Manufacturing
      - label: é›¶å”®
        value: Retail
      - label: æ•™è‚²
        value: Education
      - label: æˆ¿åœ°äº§
        value: Real Estate
      - label: å…¶ä»–
        value: Other
        
  # Lead Scoring & AI
  - name: LeadScore
    type: number
    label: çº¿ç´¢è¯„åˆ†
    precision: 0
    min: 0
    max: 100
    readonly: true
    description: AI è‡ªåŠ¨è®¡ç®—çš„çº¿ç´¢è´¨é‡åˆ†æ•° (0-100)
    
  - name: DataCompleteness
    type: percent
    label: èµ„æ–™å®Œæ•´åº¦
    readonly: true
    description: çº¿ç´¢ä¿¡æ¯å¡«å†™å®Œæ•´åº¦ç™¾åˆ†æ¯”
    
  - name: LastActivityDate
    type: datetime
    label: æœ€åæ´»åŠ¨æ—¶é—´
    readonly: true
    
  - name: NumberOfActivities
    type: number
    label: æ´»åŠ¨æ¬¡æ•°
    readonly: true
    precision: 0
    
  # Public Pool (å…¬æµ·æ± )
  - name: IsInPublicPool
    type: checkbox
    label: åœ¨å…¬æµ·æ± ä¸­
    defaultValue: true
    description: æ˜¯å¦åœ¨å…¬æµ·æ± ä¸­ç­‰å¾…åˆ†é…
    
  - name: PoolEntryDate
    type: datetime
    label: è¿›å…¥å…¬æµ·æ—¶é—´
    readonly: true
    
  - name: ClaimedDate
    type: datetime
    label: è®¤é¢†æ—¶é—´
    readonly: true
    
  # Assignment
  - name: OwnerId
    type: lookup
    label: è´Ÿè´£äºº
    referenceTo: User
    required: true
    
  # Conversion
  - name: ConvertedDate
    type: datetime
    label: è½¬åŒ–æ—¥æœŸ
    readonly: true
    
  - name: ConvertedAccountId
    type: lookup
    label: è½¬åŒ–åçš„å®¢æˆ·
    referenceTo: Account
    readonly: true
    
  - name: ConvertedContactId
    type: lookup
    label: è½¬åŒ–åçš„è”ç³»äºº
    referenceTo: Contact
    readonly: true
    
  - name: ConvertedOpportunityId
    type: lookup
    label: è½¬åŒ–åçš„å•†æœº
    referenceTo: Opportunity
    readonly: true
    
  # Campaign
  - name: CampaignId
    type: lookup
    label: è¥é”€æ´»åŠ¨
    referenceTo: Campaign
    
  # Additional Info
  - name: NumberOfEmployees
    type: number
    label: å‘˜å·¥æ•°
    precision: 0
    
  - name: AnnualRevenue
    type: currency
    label: å¹´è¥æ”¶
    precision: 2
    
  - name: Description
    type: textarea
    label: æè¿°
    length: 32000
    
  # AI Enhancement Fields
  - name: AISummary
    type: textarea
    label: AI çº¿ç´¢åˆ†æ
    readonly: true
    length: 2000
    description: AI ç”Ÿæˆçš„çº¿ç´¢è´¨é‡åˆ†æå’Œå»ºè®®
    
  - name: AIRecommendedAction
    type: text
    label: AI æ¨èè¡ŒåŠ¨
    readonly: true
    length: 255
    
  - name: EmailSignatureData
    type: textarea
    label: é‚®ä»¶ç­¾åæå–ä¿¡æ¯
    readonly: true
    description: AI ä»é‚®ä»¶ç­¾åæå–çš„è”ç³»ä¿¡æ¯

# Relationships
relationships:
  - name: Activities
    type: hasMany
    object: Activity
    foreignKey: WhoId
    label: æ´»åŠ¨è®°å½•
    
  - name: CampaignMembers
    type: hasMany
    object: CampaignMember
    foreignKey: LeadId
    label: è¥é”€æ´»åŠ¨æˆå‘˜

# List Views
listViews:
  - name: AllLeads
    label: æ‰€æœ‰çº¿ç´¢
    filters: []
    columns:
      - Name
      - Company
      - Email
      - Phone
      - Status
      - Rating
      - LeadScore
      - Owner
    sortBy: CreatedDate
    sortOrder: desc
    
  - name: MyLeads
    label: æˆ‘çš„çº¿ç´¢
    filters:
      - field: OwnerId
        operator: equals
        value: $CurrentUser.Id
    columns:
      - Name
      - Company
      - Email
      - Status
      - Rating
      - LeadScore
      - LastActivityDate
    sortBy: LeadScore
    sortOrder: desc
    
  - name: PublicPool
    label: å…¬æµ·æ± 
    filters:
      - field: IsInPublicPool
        operator: equals
        value: true
      - field: Status
        operator: notIn
        value: [Converted, Unqualified]
    columns:
      - Name
      - Company
      - Email
      - Phone
      - Rating
      - LeadScore
      - PoolEntryDate
    sortBy: LeadScore
    sortOrder: desc
    
  - name: HighScoreLeads
    label: é«˜åˆ†çº¿ç´¢
    filters:
      - field: LeadScore
        operator: greaterThan
        value: 70
      - field: Status
        operator: notEquals
        value: Converted
    columns:
      - Name
      - Company
      - Email
      - LeadScore
      - Rating
      - LastActivityDate
      - Owner
    sortBy: LeadScore
    sortOrder: desc
    
  - name: RecentLeads
    label: æœ€è¿‘çº¿ç´¢
    filters:
      - field: CreatedDate
        operator: last_n_days
        value: 7
    columns:
      - Name
      - Company
      - Email
      - Phone
      - LeadSource
      - Status
      - CreatedDate
    sortBy: CreatedDate
    sortOrder: desc
    
  - name: ToBeNurtured
    label: å¾…åŸ¹è‚²
    filters:
      - field: Status
        operator: equals
        value: Nurturing
    columns:
      - Name
      - Company
      - Email
      - Rating
      - LastActivityDate
      - NumberOfActivities
      - Owner
    sortBy: LastActivityDate
    sortOrder: asc

# Page Layout
pageLayout:
  sections:
    - label: åŸºæœ¬ä¿¡æ¯
      columns: 2
      fields:
        - Name
        - Company
        - Title
        - Email
        - Phone
        - MobilePhone
        - Website
        - Industry
        
    - label: åˆ†ç±»ä¸è¯„åˆ†
      columns: 2
      fields:
        - Status
        - Rating
        - LeadSource
        - LeadScore
        - DataCompleteness
        - CampaignId
        
    - label: åœ°å€ä¿¡æ¯
      columns: 2
      fields:
        - Street
        - City
        - State
        - PostalCode
        - Country
        
    - label: å…¬å¸ä¿¡æ¯
      columns: 2
      fields:
        - NumberOfEmployees
        - AnnualRevenue
        
    - label: å…¬æµ·æ± ç®¡ç†
      columns: 2
      fields:
        - IsInPublicPool
        - PoolEntryDate
        - ClaimedDate
        - OwnerId
        
    - label: è½¬åŒ–ä¿¡æ¯
      columns: 2
      fields:
        - ConvertedDate
        - ConvertedAccountId
        - ConvertedContactId
        - ConvertedOpportunityId
        
    - label: AI æ™ºèƒ½åˆ†æ
      columns: 1
      fields:
        - AISummary
        - AIRecommendedAction
        - EmailSignatureData
        
    - label: å…¶ä»–ä¿¡æ¯
      columns: 1
      fields:
        - Description

# Validation Rules
validationRules:
  - name: EmailOrPhoneRequired
    errorMessage: é‚®ç®±æˆ–ç”µè¯è‡³å°‘éœ€è¦å¡«å†™ä¸€ä¸ª
    formula: |
      AND(
        ISBLANK(Email),
        ISBLANK(Phone),
        ISBLANK(MobilePhone)
      )
      
  - name: ConvertedLeadReadOnly
    errorMessage: å·²è½¬åŒ–çš„çº¿ç´¢ä¸èƒ½ä¿®æ”¹çŠ¶æ€
    formula: |
      AND(
        Status = "Converted",
        PRIORVALUE(Status) = "Converted"
      )
      
  - name: HighRevenueRequiresIndustry
    errorMessage: å¹´è¥æ”¶è¶…è¿‡1000ä¸‡çš„çº¿ç´¢å¿…é¡»é€‰æ‹©è¡Œä¸š
    formula: |
      AND(
        AnnualRevenue > 10000000,
        ISBLANK(Industry)
      )

# Triggers
triggers:
  - name: LeadScoringTrigger
    event: beforeInsert, beforeUpdate
    description: è‡ªåŠ¨è®¡ç®—çº¿ç´¢è¯„åˆ†
    
  - name: PublicPoolManagement
    event: afterInsert, afterUpdate
    description: ç®¡ç†å…¬æµ·æ± è¿›å…¥å’Œè®¤é¢†é€»è¾‘
    
  - name: DataCompletenessCalculation
    event: beforeInsert, beforeUpdate
    description: è®¡ç®—èµ„æ–™å®Œæ•´åº¦
