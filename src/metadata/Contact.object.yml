# Contact Object Definition
# Follows @objectstack/spec standard for enterprise CRM

name: Contact
label: 联系人
labelPlural: 联系人
icon: user
description: 个人联系人管理

# Enable core features
features:
  searchable: true
  trackFieldHistory: true
  enableActivities: true
  enableNotes: true

# Field Definitions
fields:
  # Name Information
  - name: FirstName
    type: text
    label: 名
    length: 40
    
  - name: LastName
    type: text
    label: 姓
    required: true
    searchable: true
    length: 80
    
  - name: Salutation
    type: select
    label: 称谓
    options:
      - label: 先生
        value: Mr.
      - label: 女士
        value: Ms.
      - label: 博士
        value: Dr.
      - label: 教授
        value: Prof.
        
  # Account Relationship (Master-Detail)
  - name: AccountId
    type: masterDetail
    label: 所属客户
    referenceTo: Account
    required: true
    cascadeDelete: true
    
  # Job Information
  - name: Title
    type: text
    label: 职位
    length: 128
    
  - name: Department
    type: text
    label: 部门
    length: 80
    
  - name: Level
    type: select
    label: 职级
    options:
      - label: C级高管
        value: C-Level
      - label: VP级
        value: VP
      - label: 总监
        value: Director
      - label: 经理
        value: Manager
      - label: 专员
        value: Individual Contributor
        
  # Contact Information
  - name: Email
    type: email
    label: 邮箱
    unique: true
    
  - name: Phone
    type: phone
    label: 电话
    
  - name: MobilePhone
    type: phone
    label: 手机
    
  - name: Fax
    type: phone
    label: 传真
    
  # Address
  - name: MailingStreet
    type: textarea
    label: 邮寄地址（街道）
    rows: 2
    
  - name: MailingCity
    type: text
    label: 邮寄地址（城市）
    length: 40
    
  - name: MailingState
    type: text
    label: 邮寄地址（省份）
    length: 40
    
  - name: MailingPostalCode
    type: text
    label: 邮寄地址（邮编）
    length: 20
    
  - name: MailingCountry
    type: text
    label: 邮寄地址（国家）
    length: 40
    
  # Relationship Information
  - name: ReportsToId
    type: lookup
    label: 汇报给
    referenceTo: Contact
    
  - name: LeadSource
    type: select
    label: 线索来源
    options:
      - label: Web
        value: Web
      - label: 电话咨询
        value: Phone Inquiry
      - label: 合作伙伴推荐
        value: Partner Referral
      - label: 已购客户推荐
        value: Purchased Customer Referral
      - label: 展会
        value: Trade Show
      - label: 其他
        value: Other
        
  # Status
  - name: IsActive
    type: checkbox
    label: 有效联系人
    defaultValue: true
    
  - name: DoNotCall
    type: checkbox
    label: 禁止致电
    defaultValue: false
    
  - name: HasOptedOutOfEmail
    type: checkbox
    label: 拒收邮件
    defaultValue: false
    
  # Social Media
  - name: LinkedInUrl
    type: url
    label: LinkedIn
    
  - name: WeChatId
    type: text
    label: 微信号
    length: 80
    
  # Other
  - name: Description
    type: textarea
    label: 描述
    rows: 5
    
  - name: Birthdate
    type: date
    label: 生日
    
  # Ownership
  - name: OwnerId
    type: lookup
    label: 负责人
    referenceTo: User
    required: true
    defaultValue: $currentUser

# Relationships
relationships:
  - name: Opportunities
    type: hasMany
    object: Opportunity
    foreignKey: ContactId
    label: 商机
    
  - name: DirectReports
    type: hasMany
    object: Contact
    foreignKey: ReportsToId
    label: 下属

# List Views
listViews:
  - name: All
    label: 所有联系人
    filters: []
    columns:
      - FirstName
      - LastName
      - AccountId
      - Title
      - Email
      - Phone
      
  - name: MyContacts
    label: 我的联系人
    filters:
      - field: OwnerId
        operator: equals
        value: $currentUser
    columns:
      - FirstName
      - LastName
      - AccountId
      - Title
      - Phone
      - Email
      
  - name: ActiveContacts
    label: 有效联系人
    filters:
      - field: IsActive
        operator: equals
        value: true
    columns:
      - FirstName
      - LastName
      - AccountId
      - Title
      - Phone
      - Email
      
  - name: Executives
    label: 高管
    filters:
      - field: Level
        operator: in
        value: [C-Level, VP]
    columns:
      - FirstName
      - LastName
      - AccountId
      - Title
      - Level
      - Phone

# Page Layout
pageLayout:
  sections:
    - label: 基本信息
      columns: 2
      fields:
        - Salutation
        - FirstName
        - LastName
        - AccountId
        - Title
        - Department
        - Level
        - OwnerId
        
    - label: 联系方式
      columns: 2
      fields:
        - Email
        - Phone
        - MobilePhone
        - Fax
        - LinkedInUrl
        - WeChatId
        
    - label: 邮寄地址
      columns: 2
      fields:
        - MailingStreet
        - MailingCity
        - MailingState
        - MailingPostalCode
        - MailingCountry
        
    - label: 其他信息
      columns: 2
      fields:
        - ReportsToId
        - LeadSource
        - Birthdate
        - IsActive
        - DoNotCall
        - HasOptedOutOfEmail
        
    - label: 描述
      columns: 1
      fields:
        - Description

# Validation Rules
validationRules:
  - name: RequireEmailOrPhone
    errorMessage: 必须至少填写一个联系方式（邮箱或电话）
    formula: |
      AND(
        ISBLANK(Email),
        ISBLANK(Phone),
        ISBLANK(MobilePhone)
      )
